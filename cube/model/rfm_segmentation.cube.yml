cubes:
  - name: rfm_segmentation_scores
    title: RFM segmentation scores
    sql_table: "{ COMPILE_CONTEXT.securityContext.dataset }.rfm_segmentation_scores"
    data_source: default

    joins: []

    dimensions:
      - name: source
        title: Source
        sql: source
        type: string

      - name: segment
        title: Segment
        sql: segment_label
        type: string

      - name: email
        title: Email
        sql: email
        type: string

      - name: first_name
        title: First name
        sql: first_name
        type: string

      - name: last_name
        title: Last name
        sql: last_name
        type: string

    measures:
      - name: number_of_customers
        title: Number of customers
        type: count_distinct
        sql: eyk_customer_id
        format: number

      - name: average_order_count
        title: Average order count
        type: avg
        sql: order_count
        format: number

      - name: average_orders_last_year
        title: Average orders last year
        type: avg
        sql: order_count_year
        format: number

      - name: average_days_since_last_purchase
        title: Average days since last purchase
        type: avg
        sql: days_since_last_purchase
        format: number

      - name: average_total_order_amount
        title: Average total order amount
        type: avg
        sql: total_order_amount
        format: number

      - name: total_order_amount
        title: Total order amount
        type: sum
        sql: total_order_amount
        format: number

    pre_aggregations:
      # Pre-aggregation definitions go here.
      # Learn more in the documentation: https://cube.dev/docs/caching/pre-aggregations/getting-started
